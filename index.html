<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="منصة الهدى الإسلامية الشاملة - قرآن، سنة، مواقيت صلاة، وقصص الأنبياء">
    <title>منصة الهدى الشاملة | أحمد وائل</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400&family=Cairo:wght@300;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- متغيرات الألوان والتأسيس --- */
        :root {
            --primary: #0f3d3e; /* أخضر ملكي عميق */
            --primary-light: #1a5f5f;
            --accent: #d4af37; /* ذهبي */
            --accent-hover: #b5922f;
            --bg-light: #f4f7f6;
            --text-dark: #2c3e50;
            --glass: rgba(255, 255, 255, 0.9);
            --glass-dark: rgba(15, 61, 62, 0.95);
            --shadow: 0 10px 30px rgba(0,0,0,0.08);
            --radius: 16px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; }
        
        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-light);
            background-image: radial-gradient(#d4af37 0.5px, transparent 0.5px), radial-gradient(#d4af37 0.5px, var(--bg-light) 0.5px);
            background-size: 20px 20px;
            color: var(--text-dark);
            overflow-x: hidden;
        }

        /* --- Scrollbar --- */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #e0e0e0; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 5px; border: 2px solid #e0e0e0; }

        /* --- Hero & Header --- */
        .hero {
            background: linear-gradient(135deg, var(--primary), #051b1b);
            color: white;
            padding: 120px 20px 60px;
            text-align: center;
            position: relative;
            clip-path: polygon(0 0, 100% 0, 100% 90%, 50% 100%, 0 90%);
            margin-bottom: 40px;
        }

        .hero h1 {
            font-family: 'Amiri', serif;
            font-size: 3.5rem;
            color: var(--accent);
            text-shadow: 0 5px 15px rgba(0,0,0,0.3);
            margin-bottom: 10px;
            animation: fadeInDown 1s ease;
        }

        .hero p { font-size: 1.2rem; opacity: 0.9; font-weight: 300; }

        .date-badge {
            background: rgba(255,255,255,0.1);
            padding: 8px 20px;
            border-radius: 50px;
            border: 1px solid var(--accent);
            display: inline-block;
            margin-top: 20px;
            backdrop-filter: blur(5px);
        }

        /* --- Navigation --- */
        .navbar {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--glass-dark);
            backdrop-filter: blur(15px);
            padding: 10px 30px;
            border-radius: 50px;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            gap: 10px;
            width: max-content;
            max-width: 95%;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.7);
            padding: 10px 15px;
            font-family: 'Cairo';
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
            border-radius: 20px;
            font-size: 0.95rem;
        }

        .nav-btn:hover, .nav-btn.active {
            color: var(--accent);
            background: rgba(255,255,255,0.1);
            transform: translateY(-2px);
        }

        /* --- Layout & Sections --- */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section {
            display: none;
            animation: fadeUp 0.6s ease forwards;
            padding-bottom: 100px;
        }
        .section.active { display: block; }

        .section-header {
            text-align: center;
            margin-bottom: 40px;
        }
        .section-header h2 {
            font-family: 'Amiri';
            font-size: 2.5rem;
            color: var(--primary);
            position: relative;
            display: inline-block;
        }
        .section-header h2::after {
            content: '';
            display: block;
            width: 60px;
            height: 4px;
            background: var(--accent);
            margin: 10px auto 0;
            border-radius: 2px;
        }

        /* --- Prayer Times Widget --- */
        .prayer-times-strip {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: -50px;
            position: relative;
            z-index: 10;
            margin-bottom: 40px;
        }

        .prayer-card {
            background: white;
            padding: 15px 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow);
            min-width: 100px;
            border-bottom: 4px solid var(--primary);
            transition: 0.3s;
        }
        .prayer-card.next-prayer {
            background: var(--primary);
            color: white;
            border-bottom-color: var(--accent);
            transform: scale(1.1);
        }
        .prayer-card h4 { font-size: 0.9rem; margin-bottom: 5px; opacity: 0.8; }
        .prayer-card span { font-weight: 900; font-size: 1.2rem; }

        /* --- Cards Grid --- */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .card {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            border: 1px solid rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0; right: 0; width: 100%; height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
        }

        .card h3 { color: var(--primary); margin-bottom: 10px; font-family: 'Amiri'; font-weight: bold; }
        .card p { font-size: 0.95rem; line-height: 1.7; color: #555; }
        
        /* --- Quran Specific --- */
        .controls-area {
            background: white;
            padding: 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }
        select {
            padding: 12px 20px;
            border-radius: 10px;
            border: 1px solid #ddd;
            font-family: 'Cairo';
            min-width: 200px;
            outline: none;
        }
        .play-btn-lg {
            background: var(--primary);
            color: white;
            width: 60px; height: 60px;
            border-radius: 50%;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(15, 61, 62, 0.4);
            transition: 0.3s;
            display: flex; align-items: center; justify-content: center;
        }
        .play-btn-lg:hover { transform: scale(1.1); background: var(--primary-light); }

        .quran-display {
            background: #fffcf2; /* لون ورقي */
            padding: 50px;
            border-radius: var(--radius);
            box-shadow: inset 0 0 30px rgba(0,0,0,0.05);
            border: 1px solid #e3dcc5;
            min-height: 300px;
            font-family: 'Amiri';
            font-size: 1.8rem;
            line-height: 2.8;
            text-align: center;
            position: relative;
        }

        /* --- Tasbih --- */
        .tasbih-ring {
            width: 200px; height: 200px;
            border-radius: 50%;
            border: 10px solid #eee;
            border-top-color: var(--accent);
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            font-weight: 900;
            color: var(--primary);
            cursor: pointer;
            user-select: none;
            transition: 0.1s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            background: white;
        }
        .tasbih-ring:active { transform: scale(0.95); border-top-color: var(--primary); }

        /* --- Audio Player Sticky --- */
        .audio-bar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            width: 90%;
            max-width: 600px;
            background: var(--glass-dark);
            backdrop-filter: blur(10px);
            padding: 15px 25px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            z-index: 2000;
            transition: 0.5s;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        .audio-bar.visible { transform: translateX(-50%) translateY(0); }
        .audio-bar audio { width: 100%; height: 35px; outline: none; }

        /* --- Footer --- */
        footer {
            background: var(--primary);
            color: white;
            padding: 50px 20px;
            text-align: center;
            margin-top: auto;
        }
        .social-links a {
            color: white; font-size: 1.5rem; margin: 0 15px;
            transition: 0.3s;
        }
        .social-links a:hover { color: var(--accent); }

        /* Animations */
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* Mobile Tweaks */
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            .navbar { width: 90%; padding: 10px; bottom: 20px; top: auto; }
            .audio-bar { bottom: 90px; }
            .controls-area { flex-direction: column; }
            select { width: 100%; }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <button class="nav-btn active" onclick="switchTab('home', this)"><i class="fas fa-home"></i> الرئيسية</button>
        <button class="nav-btn" onclick="switchTab('quran', this)"><i class="fas fa-quran"></i> القرآن</button>
        <button class="nav-btn" onclick="switchTab('hadith', this)"><i class="fas fa-book-open"></i> الحديث</button>
        <button class="nav-btn" onclick="switchTab('stories', this)"><i class="fas fa-history"></i> القصص</button>
        <button class="nav-btn" onclick="switchTab('tools', this)"><i class="fas fa-mosque"></i> الأدوات</button>
    </nav>

    <header class="hero">
        <div class="container">
            <h1>منصة الهدى الإسلامية</h1>
            <p>مرجعك اليومي للقرآن والسنة والعبادات</p>
            <div class="date-badge" id="hijriDate">جاري تحميل التاريخ...</div>
            <div style="margin-top: 20px;">
                <a href="https://www.facebook.com/share/17ZkigpZAL/" target="_blank" style="color:white; margin:0 10px;"><i class="fab fa-facebook fa-lg"></i></a>
                <a href="https://wa.me/201275425111" target="_blank" style="color:white; margin:0 10px;"><i class="fab fa-whatsapp fa-lg"></i></a>
                <a href="https://t.me/ahmedwael2020" target="_blank" style="color:white; margin:0 10px;"><i class="fab fa-telegram fa-lg"></i></a>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="prayer-times-strip" id="prayerContainer">
            <div class="prayer-card"><h4>الفجر</h4><span>--:--</span></div>
            <div class="prayer-card"><h4>الظهر</h4><span>--:--</span></div>
            <div class="prayer-card"><h4>العصر</h4><span>--:--</span></div>
            <div class="prayer-card"><h4>المغرب</h4><span>--:--</span></div>
            <div class="prayer-card"><h4>العشاء</h4><span>--:--</span></div>
        </div>
    </div>

    <div class="container main-wrapper">

        <div id="home" class="section active">
            <div class="section-header">
                <h2>مختارات اليوم</h2>
            </div>
            <div class="grid-container">
                <div class="card">
                    <h3><i class="fas fa-sun" style="color:var(--accent)"></i> أذكار الصباح</h3>
                    <p>ابدأ يومك بذكر الله لتحفظك الملائكة وتبارك في يومك.</p>
                    <button onclick="switchTab('tools', document.querySelectorAll('.nav-btn')[4]); renderAdhkar('morning')" style="margin-top:15px; background:var(--primary); color:white; border:none; padding:8px 20px; border-radius:20px; cursor:pointer">اقرأ الأذكار</button>
                </div>
                <div class="card">
                    <h3><i class="fas fa-moon" style="color:#2c3e50"></i> أذكار المساء</h3>
                    <p>حصن نفسك قبل النوم وعند غروب الشمس.</p>
                    <button onclick="switchTab('tools', document.querySelectorAll('.nav-btn')[4]); renderAdhkar('evening')" style="margin-top:15px; background:var(--primary); color:white; border:none; padding:8px 20px; border-radius:20px; cursor:pointer">اقرأ الأذكار</button>
                </div>
                <div class="card">
                    <h3><i class="fas fa-random" style="color:var(--accent)"></i> حديث عشوائي</h3>
                    <p id="randomHadithPreview">جاري التحميل...</p>
                </div>
            </div>
        </div>

        <div id="quran" class="section">
            <div class="section-header">
                <h2>المصحف الشريف</h2>
            </div>
            
            <div class="controls-area">
                <div>
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">القارئ:</label>
                    <select id="reciterSelect" onchange="updateAudioSource()">
                        <option value="" disabled selected>جاري تحميل القراء...</option>
                    </select>
                </div>
                <div>
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">السورة:</label>
                    <select id="surahSelect" onchange="loadSurahText()">
                        <option value="" disabled selected>اختر السورة...</option>
                    </select>
                </div>
                <button class="play-btn-lg" onclick="playSurah()"><i class="fas fa-play"></i></button>
            </div>

            <div id="quranContainer" class="quran-display">
                <div style="opacity:0.5; margin-top:80px;">
                    <i class="fas fa-quran" style="font-size:3rem; margin-bottom:20px;"></i><br>
                    اختر سورة واستمع لتلاوة خاشعة
                </div>
            </div>
        </div>

        <div id="hadith" class="section">
            <div class="section-header">
                <h2>الأربعون النووية</h2>
                <p>الأحاديث الصحيحة الجامعة لقواعد الإسلام</p>
            </div>
            <input type="text" id="hadithSearch" placeholder="ابحث في الأحاديث..." onkeyup="filterHadith()" style="width:100%; padding:15px; border-radius:10px; border:1px solid #ddd; margin-bottom:30px; font-family:'Cairo'">
            <div id="hadithList" class="grid-container">
                </div>
        </div>

        <div id="stories" class="section">
            <div class="section-header">
                <h2>قصص الأنبياء</h2>
                <p>عبر ومواعظ من حياة الرسل عليهم السلام</p>
            </div>
            <input type="text" id="storySearch" placeholder="ابحث عن اسم نبي..." onkeyup="filterStories()" style="width:100%; padding:15px; border-radius:10px; border:1px solid #ddd; margin-bottom:30px; font-family:'Cairo'">
            <div id="storiesList" class="grid-container">
                </div>
        </div>

        <div id="tools" class="section">
            <div class="section-header">
                <h2>أدوات المسلم</h2>
            </div>

            <div class="grid-container">
                <div class="card" style="text-align:center; grid-column: span 1;">
                    <h3>السبحة الإلكترونية</h3>
                    <div class="tasbih-ring" id="tasbihCounter" onclick="incrementTasbih()">0</div>
                    <div style="display:flex; justify-content:center; gap:10px;">
                        <button onclick="incrementTasbih()" style="padding:10px 30px; background:var(--primary); color:white; border:none; border-radius:10px;">سبح</button>
                        <button onclick="resetTasbih()" style="padding:10px 30px; background:#ddd; color:#333; border:none; border-radius:10px;">تصفير</button>
                    </div>
                </div>

                <div class="card" style="grid-column: span 1;">
                    <h3><i class="fas fa-broadcast-tower"></i> إذاعة القرآن الكريم</h3>
                    <p>بث مباشر من القاهرة 24 ساعة</p>
                    <audio controls style="width:100%; margin-top:20px;">
                        <source src="https://n02.radiojar.com/8s5u5tpdtwzuv?rj-ttl=5&rj-tok=AAABjF_2l7AAjF_2l7AAjF_2l7A" type="audio/mpeg">
                    </audio>
                </div>

                <div class="card" style="grid-column: 1 / -1;">
                    <h3><i class="fas fa-praying-hands"></i> حصن المسلم</h3>
                    <div style="margin:15px 0;">
                        <button onclick="renderAdhkar('morning')" style="background:var(--accent); color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer">أذكار الصباح</button>
                        <button onclick="renderAdhkar('evening')" style="background:var(--primary); color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer">أذكار المساء</button>
                    </div>
                    <div id="adhkarContent" style="max-height:400px; overflow-y:auto; padding:10px;">
                        اختر الأذكار للعرض...
                    </div>
                </div>
            </div>
        </div>

    </div> <div class="audio-bar" id="stickyPlayer">
        <div style="flex:1;">
            <div id="playerTitle" style="font-size:0.9rem; font-weight:bold; color:var(--accent)">القرآن الكريم</div>
            <div id="playerSub" style="font-size:0.7rem;">اختر سورة للتشغيل</div>
        </div>
        <audio id="mainAudio" controls></audio>
        <button onclick="closePlayer()" style="background:none; border:none; color:white; cursor:pointer"><i class="fas fa-times"></i></button>
    </div>

    <footer>
        <div class="container">
            <h3>منصة الهدى الإسلامية</h3>
            <p>برمجة وتطوير: <strong style="color:var(--accent)">أحمد وائل</strong></p>
            <div class="social-links" style="margin-top:20px;">
                <a href="https://www.facebook.com/share/17ZkigpZAL/" target="_blank"><i class="fab fa-facebook"></i></a>
                <a href="https://wa.me/201275425111" target="_blank"><i class="fab fa-whatsapp"></i></a>
                <a href="https://t.me/ahmedwael2020" target="_blank"><i class="fab fa-telegram"></i></a>
            </div>
            <p style="margin-top:20px; font-size:0.8rem; opacity:0.6;">جميع الحقوق محفوظة © 2025</p>
        </div>
    </footer>

    <script>
        // --- البيانات (Data) --- //

        // 1. قصص الأنبياء (شاملة)
        const storiesData = [
            { name: "آدم عليه السلام", desc: "أبو البشر، خلقه الله بيده من طين، وأسجد له الملائكة، وعلمه الأسماء كلها، وأسكنه الجنة ثم أهبطه للأرض ليعمرها." },
            { name: "إدريس عليه السلام", desc: "أول من خط بالقلم، ورفعه الله مكاناً علياً، وكان صديقاً نبياً." },
            { name: "نوح عليه السلام", desc: "شيخ المرسلين، لبث في قومه 950 سنة يدعوهم، وبنى السفينة بأمر الله لتكون نجاة للمؤمنين من الطوفان العظيم." },
            { name: "هود عليه السلام", desc: "أرسل إلى قوم عاد الذين كانوا يسكنون الأحقاف، وكانوا أولي قوة وبطش، فأهلكهم الله بالريح العقيم." },
            { name: "صالح عليه السلام", desc: "نبي قوم ثمود، كانت معجزته الناقة التي خرجت من الصخرة، فعقروها فأخذتهم الصيحة." },
            { name: "إبراهيم عليه السلام", desc: "خليل الله، وأبو الأنبياء. بنى الكعبة، وحطم الأصنام، ونجاه الله من النار." },
            { name: "لوط عليه السلام", desc: "أرسل إلى أهل سدوم الذين أتوا الفاحشة التي لم يسبقهم بها أحد، فجعل الله عالي قريتهم سافلها." },
            { name: "إسماعيل عليه السلام", desc: "الذبيح، جد العرب، شارك أباه إبراهيم في بناء الكعبة، وصبر على أمر الذبح ففداه الله بكبش عظيم." },
            { name: "إسحاق عليه السلام", desc: "ابن إبراهيم وبشرته به الملائكة، ومن نسله جاء يعقوب والأسباط." },
            { name: "يعقوب عليه السلام", desc: "هو إسرائيل، ابتلي بفقد ولده يوسف وحزنه الشديد عليه حتى ابيضت عيناه." },
            { name: "يوسف عليه السلام", desc: "الكريم ابن الكريم، مر بمحنة الجب، والرق، والسجن، وفتنة النساء، حتى مكنه الله في الأرض." },
            { name: "أيوب عليه السلام", desc: "رمز الصبر، ابتلاه الله في ماله وولده وجسده سنين طوال، فصبر وشكر حتى كشف الله ضره." },
            { name: "شعيب عليه السلام", desc: "خطيب الأنبياء، أرسل إلى أهل مدين الذين كانوا يبخسون المكيال والميزان." },
            { name: "موسى عليه السلام", desc: "كليم الله، أولي العزم، أرسل لفرعون، شق له الله البحر، وأنزل عليه التوراة." },
            { name: "هارون عليه السلام", desc: "أخو موسى ووزيره، فصيح اللسان، استخلفه موسى على قومه حين ذهب لميقات ربه." },
            { name: "داود عليه السلام", desc: "ألان الله له الحديد، وسخر له الجبال والطير يسبحن معه، وأتاه الملك والحكمة." },
            { name: "سليمان عليه السلام", desc: "ورث داود، سخر الله له الجن والريح، وعلم منطق الطير، ملكاً لا ينبغي لأحد من بعده." },
            { name: "إلياس عليه السلام", desc: "أرسل إلى قوم يعبدون صنماً يسمى بعلاً، فدعاهم إلى الله." },
            { name: "اليسع عليه السلام", desc: "من أنبياء بني إسرائيل، خلف إلياس في الدعوة إلى الله." },
            { name: "يونس عليه السلام", desc: "ذا النون، التقمه الحوت، فنادى في الظلمات (لا إله إلا أنت سبحانك إني كنت من الظالمين)." },
            { name: "زكريا عليه السلام", desc: "كفل مريم، ودعا ربه أن يرزقه ولداً يرث النبوة، فبشرته الملائكة بيحيى." },
            { name: "يحيى عليه السلام", desc: "النبي الزاهد، أتاه الله الحكم صبياً، وكان سيداً وحصوراً." },
            { name: "عيسى عليه السلام", desc: "كلمة الله وروحه، ولد بلا أب، تكلم في المهد، وأبرأ الأكمه والأبرص وأحيا الموتى بإذن الله." },
            { name: "محمد ﷺ", desc: "خاتم الأنبياء والمرسلين، سيد ولد آدم، صاحب الشفاعة العظمى، أرسل رحمة للعالمين بالقرآن الكريم." }
        ];

        // 2. الأحاديث (عينة من الأربعين النووية - يمكن توسيعها لتشمل الـ 40 كاملة بنفس النمط)
        const hadithData = [
            { t: "الأعمال بالنيات", txt: "عن أمير المؤمنين أبي حفص عمر بن الخطاب رضي الله عنه قال: سمعت رسول الله ﷺ يقول: «إنما الأعمال بالنيات، وإنما لكل امرئ ما نوى، فمن كانت هجرته إلى الله ورسوله فهجرته إلى الله ورسوله، ومن كانت هجرته لدنيا يصيبها أو امرأة ينكحها فهجرته إلى ما هاجر إليه»." },
            { t: "مراتب الدين", txt: "عن عمر رضي الله عنه أيضاً قال: بينما نحن جلوس عند رسول الله ﷺ ذات يوم، إذ طلع علينا رجل شديد بياض الثياب، شديد سواد الشعر... (الحديث الطويل عن الإسلام والإيمان والإحسان)." },
            { t: "أركان الإسلام", txt: "عن أبي عبد الرحمن عبد الله بن عمر بن الخطاب رضي الله عنهما قال: سمعت رسول الله ﷺ يقول: «بني الإسلام على خمس: شهادة أن لا إله إلا الله وأن محمداً رسول الله، وإقام الصلاة، وإيتاء الزكاة، وحج البيت، وصوم رمضان»." },
            { t: "مراحل الخلق", txt: "عن عبد الله بن مسعود رضي الله عنه قال: حدثنا رسول الله ﷺ وهو الصادق المصدوق: «إن أحدكم يجمع خلقه في بطن أمه أربعين يوماً نطفة...»." },
            { t: "النهي عن البدع", txt: "عن أم المؤمنين أم عبد الله عائشة رضي الله عنها قالت: قال رسول الله ﷺ: «من أحدث في أمرنا هذا ما ليس منه فهو رد»." },
            { t: "الحلال والحرام", txt: "عن النعمان بن بشير رضي الله عنهما قال: سمعت رسول الله ﷺ يقول: «إن الحلال بين، وإن الحرام بين، وبينهما أمور مشتبهات...»." },
            { t: "الدين النصيحة", txt: "عن تميم الداري رضي الله عنه أن النبي ﷺ قال: «الدين النصيحة». قلنا: لمن؟ قال: «لله، ولكتابه، ولرسوله، ولأئمة المسلمين وعامتهم»." },
            // ... يمكن إضافة باقي الأربعين هنا ...
            { t: "حرمة دم المسلم", txt: "عن ابن مسعود رضي الله عنه قال: قال رسول الله ﷺ: «لا يحل دم امرئ مسلم يشهد أن لا إله إلا الله وأني رسول الله إلا بإحدى ثلاث...»." },
            { t: "النهي عن الغضب", txt: "عن أبي هريرة رضي الله عنه أن رجلاً قال للنبي ﷺ: أوصني. قال: «لا تغضب»، فردد مراراً، قال: «لا تغضب»." }
        ];

        // --- الوظائف البرمجية (Logic) --- //

        // 1. إدارة التبويبات
        function switchTab(id, btn) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            if(btn) {
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            }
            window.scrollTo(0, 0);
        }

        // 2. القرآن الكريم
        let audioServer = "https://server8.mp3quran.net/afs/"; // العفاسي افتراضي

        async function initQuran() {
            // جلب القراء
            try {
                const res = await fetch('https://www.mp3quran.net/api/v3/reciters?language=ar');
                const data = await res.json();
                const select = document.getElementById('reciterSelect');
                const sorted = data.reciters.sort((a,b) => a.name.localeCompare(b.name));
                
                sorted.forEach(r => {
                    if(r.moshaf && r.moshaf.length > 0) {
                        let op = document.createElement('option');
                        op.value = r.moshaf[0].server;
                        op.text = r.name;
                        select.appendChild(op);
                    }
                });
                select.value = "https://server8.mp3quran.net/afs/";
            } catch(e) { console.error("Error loading reciters"); }

            // جلب السور
            try {
                const res = await fetch('https://api.alquran.cloud/v1/surah');
                const data = await res.json();
                const select = document.getElementById('surahSelect');
                data.data.forEach(s => {
                    let op = document.createElement('option');
                    op.value = s.number;
                    op.text = `${s.number}. ${s.name}`;
                    select.appendChild(op);
                });
            } catch(e) { console.error("Error loading surahs"); }
        }

        function updateAudioSource() {
            audioServer = document.getElementById('reciterSelect').value;
        }

        async function loadSurahText() {
            const num = document.getElementById('surahSelect').value;
            const container = document.getElementById('quranContainer');
            container.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> جاري التحميل...';
            
            try {
                const res = await fetch(`https://api.alquran.cloud/v1/surah/${num}`);
                const data = await res.json();
                const ayahs = data.data.ayahs;
                
                let html = `<div style="color:var(--primary); font-family:Amiri; margin-bottom:30px;">بسم الله الرحمن الرحيم</div>`;
                ayahs.forEach(a => {
                    let txt = a.text.replace("بِسْمِ ٱللَّهِ ٱلرَّحْمَٰنِ ٱلرَّحِيمِ", ""); // إزالة البسملة من بداية السور ما عدا الفاتحة
                    if(num == 1) txt = a.text;
                    html += `${txt} <span style="color:var(--accent); font-size:0.7em;">(${a.numberInSurah})</span> `;
                });
                container.innerHTML = html;
            } catch(e) { container.innerHTML = "خطأ في التحميل"; }
        }

        function playSurah() {
            const num = document.getElementById('surahSelect').value;
            const reciterName = document.getElementById('reciterSelect').options[document.getElementById('reciterSelect').selectedIndex].text;
            const surahName = document.getElementById('surahSelect').options[document.getElementById('surahSelect').selectedIndex].text;
            
            if(!num) { alert("اختر سورة أولاً"); return; }
            
            const url = `${audioServer}/${num.toString().padStart(3, '0')}.mp3`;
            const audio = document.getElementById('mainAudio');
            
            document.getElementById('playerTitle').innerText = surahName;
            document.getElementById('playerSub').innerText = reciterName;
            
            audio.src = url;
            audio.play();
            document.getElementById('stickyPlayer').classList.add('visible');
        }
        
        function closePlayer() {
            document.getElementById('stickyPlayer').classList.remove('visible');
            document.getElementById('mainAudio').pause();
        }

        // 3. مواقيت الصلاة (Geolocation API + Aladhan API)
        function getPrayerTimes() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async position => {
                    const lat = position.coords.latitude;
                    const long = position.coords.longitude;
                    const date = new Date();
                    
                    try {
                        const res = await fetch(`https://api.aladhan.com/v1/timings/${date.getDate()}-${date.getMonth()+1}-${date.getFullYear()}?latitude=${lat}&longitude=${long}&method=5`);
                        const data = await res.json();
                        const timings = data.data.timings;
                        const hijri = data.data.date.hijri;
                        
                        // تحديث التاريخ
                        document.getElementById('hijriDate').innerText = `${hijri.day} ${hijri.month.ar} ${hijri.year} هـ`;
                        
                        // تحديث البطاقات
                        const container = document.getElementById('prayerContainer');
                        container.innerHTML = `
                            <div class="prayer-card"><h4>الفجر</h4><span>${timings.Fajr}</span></div>
                            <div class="prayer-card"><h4>الظهر</h4><span>${timings.Dhuhr}</span></div>
                            <div class="prayer-card"><h4>العصر</h4><span>${timings.Asr}</span></div>
                            <div class="prayer-card"><h4>المغرب</h4><span>${timings.Maghrib}</span></div>
                            <div class="prayer-card"><h4>العشاء</h4><span>${timings.Isha}</span></div>
                        `;
                        
                        highlightNextPrayer(timings);

                    } catch(e) { console.log("Error fetching prayer times"); }
                }, () => {
                    // Fallback for default location (Cairo)
                    document.getElementById('hijriDate').innerText = "قم بتفعيل الموقع للدقة";
                    fetchPrayerByCity("Cairo", "Egypt");
                });
            }
        }

        async function fetchPrayerByCity(city, country) {
             // دالة بديلة في حال رفض الموقع
             const res = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=5`);
             const data = await res.json();
             // ... (نفس منطق التحديث أعلاه)
        }

        function highlightNextPrayer(timings) {
            // منطق بسيط لتحديد الصلاة القادمة (يحتاج لتحويل الوقت لنظام 24 ومقارنته)
            // هذه خطوة متقدمة، سنتركها بسيطة الآن
        }

        // 4. تحميل المحتوى (قصص وأحاديث)
        function loadContent() {
            // قصص
            const sList = document.getElementById('storiesList');
            storiesData.forEach(s => {
                sList.innerHTML += `
                <div class="card story-card">
                    <h3>${s.name}</h3>
                    <p>${s.desc}</p>
                </div>`;
            });

            // أحاديث
            const hList = document.getElementById('hadithList');
            hadithData.forEach(h => {
                hList.innerHTML += `
                <div class="card hadith-card">
                    <h3 style="font-size:1.2rem;">${h.t}</h3>
                    <p style="font-family:Amiri; font-size:1.1rem; color:#333;">${h.txt}</p>
                </div>`;
            });

            // حديث عشوائي للرئيسية
            const rand = hadithData[Math.floor(Math.random() * hadithData.length)];
            document.getElementById('randomHadithPreview').innerText = rand.txt.substring(0, 100) + "...";
        }

        // 5. البحث
        function filterStories() {
            const query = document.getElementById('storySearch').value.toLowerCase();
            document.querySelectorAll('.story-card').forEach(c => {
                c.style.display = c.innerText.toLowerCase().includes(query) ? "block" : "none";
            });
        }
        function filterHadith() {
            const query = document.getElementById('hadithSearch').value.toLowerCase();
            document.querySelectorAll('.hadith-card').forEach(c => {
                c.style.display = c.innerText.toLowerCase().includes(query) ? "block" : "none";
            });
        }

        // 6. الأذكار
        const azkarDB = {
            morning: ["آية الكرسي", "أصبحنا وأصبح الملك لله...", "اللهم بك أصبحنا...", "سيد الاستغفار", "بسم الله الذي لا يضر مع اسمه شيء..."],
            evening: ["آية الكرسي", "أمسين وأمسى الملك لله...", "اللهم بك أمسينا...", "أعوذ بكلمات الله التامات من شر ما خلق"]
        };
        function renderAdhkar(type) {
            const div = document.getElementById('adhkarContent');
            div.innerHTML = azkarDB[type].map(z => `<div style="padding:10px; border-bottom:1px solid #eee; font-family:'Amiri'; font-size:1.1rem;">${z}</div>`).join('');
        }

        // 7. السبحة
        let count = 0;
        function incrementTasbih() {
            count++;
            document.getElementById('tasbihCounter').innerText = count;
            // تأثير بصري بسيط
            const ring = document.getElementById('tasbihCounter');
            ring.style.transform = "scale(0.95)";
            setTimeout(() => ring.style.transform = "scale(1)", 100);
        }
        function resetTasbih() { count = 0; document.getElementById('tasbihCounter').innerText = 0; }

        // --- التشغيل عند البدء ---
        window.onload = function() {
            initQuran();
            getPrayerTimes();
            loadContent();
        }

    </script>
</body>
</html>
